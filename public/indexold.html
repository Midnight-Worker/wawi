<!DOCTYPE html>
    <html lang="de">
    <head>
        <meta charset="UTF-8">
        <title>EAN Scanner</title>
        <style>
            body {
                font-family: sans-serif;
                margin: 20px;
            }
            #ean-input {
                width: 100%;
                font-size: 2rem;
                padding: 10px;
                box-sizing: border-box;
            }
            #result {
                margin-top: 20px;
                font-size: 1.2rem;
            }
            .error {
                color: red;
            }
        </style>
    </head>
    <body>
        <h1>EAN-Scanner</h1>
        <p>Cursor ins Feld setzen und mit Handscanner scannen (oder EAN eintippen und Enter).</p>
        <input id="ean-input" type="text" autofocus placeholder="EAN scannen..." />
        <div id="result"></div>

        <script>
            const input = document.getElementById('ean-input');
            const resultDiv = document.getElementById('result');

            function showResult(data) {
                if (!data.ok) {
                    resultDiv.innerHTML = '<p class="error">' + (data.message || 'Unbekannter Fehler') + '</p>';
                    return;
                }
                resultDiv.innerHTML = `
                    <p><strong>EAN:</strong> ${data.ean}</p>
                    <p><strong>Name:</strong> ${data.name}</p>
                    <p><strong>Marke:</strong> ${data.brand || '-'}</p>
                `;
            }

            input.addEventListener('keydown', function (e) {
                if (e.key === 'Enter') {
                    const ean = input.value.trim();
                    if (!ean) return;

                    resultDiv.innerHTML = '<p>Suche nach ' + ean + ' ...</p>';

                    // Python-API 체ber pywebview aufrufen
                    if (window.pywebview && window.pywebview.api) {
                        window.pywebview.api.lookup_ean(ean).then(showResult);
                    } else {
                        resultDiv.innerHTML = '<p class="error">pywebview API nicht verf체gbar.</p>';
                    }

                    // optional: Feld leeren f체r n채chsten Scan
                    input.value = '';
                }
            });

            // Sicherstellen, dass der Fokus im Feld bleibt (z.B. nach Klick)
            window.addEventListener('click', () => input.focus());
        </script>
    </body>
    </html>
